---
title: "ğŸ–Šï¸ Rustì™€ ë¯¸ë¶„í•˜ê¸° 02: ê¸°í˜¸ ë¯¸ë¶„"
date: 2020-10-03T03:36:49+09:00
draft: false
toc: true
images:
tags:
  - numerical
  - automatic differentiation
  - symbolic differentiation
  - rust
  - sage
  - ìë™ë¯¸ë¶„
  - ê¸°í˜¸ë¯¸ë¶„
---

> **ğŸ”– Automatic Differentiation Series**
>
> 1. [ğŸ’» Numerical Differentiation](../02_ad_1)
> 2. [ğŸ–Šï¸ Symbolic Differentiation](../02_ad_2)

## ğŸ“‰ ìˆ˜ì¹˜ì  ë¯¸ë¶„ì˜ í•œê³„

ì €ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œ ìˆ˜ì¹˜ì  ë¯¸ë¶„ì„ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒì„ ë‹¤ë¤„ë³´ì•˜ëŠ”ë°, ì–´ë– ì…¨ë‚˜ìš”?
ì•„ë§ˆ, ì½”ë”©ì— ëŒ€í•œ ì¡°ê¸ˆì˜ ì§€ì‹ë§Œ ìˆìœ¼ë©´ ì˜¤íˆë ¤ ê³ ë“±í•™êµë•Œì˜ ë¯¸ë¶„ë³´ë‹¤ í›¨ì”¬ ì‰½ê²Œ ëŠê»´ì§€ì…¨ì„ ê²ë‹ˆë‹¤.
ì €í¬ê°€ ì‚¬ìš©í•œ ê²ƒì´ë¼ê³ ëŠ” ê·¸ì € ë„í•¨ìˆ˜ì˜ ì •ì˜ì— ë”°ë¼ í•¨ìˆ˜ì— ê° êµ¬ê°„ ê°’ì„ ëŒ€ì…í•œ ê²ƒì´ ì „ë¶€ì˜€ëŠ”ë°, ì´ë¥¼ ì½”ë“œë¡œ ë‚˜íƒ€ë‚´ë©´ ê²°êµ­ ë‹¤ìŒì˜ ì½”ë“œì— ì§€ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

```python
# Python
def differentiation(f, x, h=1e-06):
  return (f(x + h) - f(x)) / h
```

ë‚˜ë¨¸ì§€ëŠ” ì´ë¥¼ ê°ì²´ì§€í–¥ì ìœ¼ë¡œ êµ¬í˜„í•˜ê±°ë‚˜, í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ìœ¼ë¡œ êµ¬í˜„í•˜ê±°ë‚˜ ì œë„ˆë¦­ í”„ë¡œê·¸ë˜ë°ì„ ë„ì…í•˜ëŠ” ë“±ì˜ êµ¬í˜„ë°©ë²•ì˜ ì°¨ì´ì¼ ë¿ì´ì—ˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ ìˆ˜ì¹˜ì  ë¯¸ë¶„ ë°©ë²•ì€ êµ‰ì¥íˆ ê°„ë‹¨í•œ êµ¬í˜„ê³¼ ì—„ì²­ ë¹ ë¥¸ ê³„ì‚°ì†ë„ë¥¼ ê°€ì ¸ì„œ ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ë¯¸ë¶„ì„ í•  ìˆ˜ ìˆê²Œ í•´ì£¼ì—ˆìŠµë‹ˆë‹¤ë§Œ, ì˜¤ì°¨ê°€ í•„ì—°ì ìœ¼ë¡œ ë°œìƒí•˜ê²Œ ë˜ëŠ” ë‹¨ì ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì˜¤ì°¨ì— í¬ê²Œ ë¯¼ê°í•˜ì§€ ì•Šì€ ë¬¸ì œë‚˜, Step ìˆ˜ê°€ ì ì–´ì„œ ì˜¤ì°¨ê°€ í¬ê²Œ ìŒ“ì´ì§€ ì•ŠëŠ” ë¯¸ë¶„ë°©ì •ì‹ì„ í‘¸ëŠ” ê²½ìš°ì—” ì¶©ë¶„í•˜ì§€ë§Œ, ì˜¤ì°¨ì— ë¯¼ê°í•˜ê±°ë‚˜ Step ìˆ˜ê°€ ë§ì•„ì„œ ì˜¤ì°¨ê°€ ìŒ“ì—¬ ìœ ì˜ë¯¸í•œ ì°¨ì´ë¥¼ ë³´ì—¬ì£¼ëŠ” ë¯¸ë¶„ë°©ì •ì‹ì˜ ê²½ìš°ì—” í° ë¬¸ì œë¥¼ ì•¼ê¸°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëŒ€í‘œì ì¸ ì˜ˆì‹œë¡œ "ë¡œë Œì¦ˆì˜ ë‚˜ë¹„"ê°€ ìˆìŠµë‹ˆë‹¤.

### ğŸ¦‹ ë¡œë Œì¦ˆì˜ ë‚˜ë¹„

![Lorenz Butterfly](/posts/images/euler.png)

ì—ë“œì›Œë“œ ë¡œë Œì¦ˆëŠ” ê±¸ì¶œí•œ ìˆ˜í•™ìë¡œ, íŠ¹íˆ ì¹´ì˜¤ìŠ¤ ì´ë¡ ì˜ ì„ êµ¬ìë¡œ ìœ ëª…í•˜ì‹  ë¶„ì…ë‹ˆë‹¤. ê·¸ëŠ” 1963ë…„ì— ëŒ€ê¸° ëŒ€ë¥˜ì˜ ê°„ë‹¨í•œ ìˆ˜í•™ì  ëª¨í˜•ì„ ë§Œë“¤ì—ˆëŠ”ë°, ì´ ëª¨ë¸ì€ ë‹¤ìŒì˜ 3ê°œì˜ ìƒë¯¸ë¶„ë°©ì •ì‹ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤.

$$
\begin{align}
\frac{dx}{dt} &= \sigma(y-x) \\\\
\frac{dy}{dt} &= x (\rho - z) - y \\\\
\frac{dz}{dt} &= xy - \beta z
\end{align}
$$

ë¶„ëª… ì•„ì£¼ ê°„ë‹¨í•œ ë¯¸ë¶„ë°©ì •ì‹ì¸ë°, ë†€ëê²Œë„ ì•„ì£¼ ë³µì¡í•œ í˜•íƒœì˜ í•´ê°€ ë„ì¶œë©ë‹ˆë‹¤. ì´ë•Œì˜ ëŒ€í‘œì ì¸ í•´ì˜ í˜•íƒœê°€ ìœ„ì—ì„œ ì²¨ë¶€í•œ ê·¸ë¦¼ì…ë‹ˆë‹¤. ì´ ì‹œìŠ¤í…œì€ êµ‰ì¥íˆ ì˜ˆë¯¼í•œë°, ë§¤ê°œë³€ìˆ˜ì˜ ê°’ì„ ì¡°ê¸ˆ ë°”ê¾¸ê±°ë‚˜ í˜¹ì€ Step sizeë¥¼ ì¡°ê¸ˆë§Œ ë°”ê¿”ë„ í•´ì˜ í˜•íƒœëŠ” ì˜ˆì¸¡í•  ìˆ˜ ì—†ëŠ” í˜•íƒœë¡œ, ê·¸ê²ƒë„ êµ‰ì¥íˆ íŒŒê²©ì ìœ¼ë¡œ ë³€í˜•ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ìœ„ì˜ ê·¸ë¦¼ì€ **ì˜¤ì¼ëŸ¬**(Euler) ë°©ë²•ì´ë¼ëŠ” ìˆ˜ì¹˜ì  ë¯¸ë¶„ë°©ì •ì‹ í•´ë²• ì¤‘ í•˜ë‚˜ë¡œ í’€ì—ˆëŠ”ë°, ìœ„ì™€ ëª¨ë“  ì¡°ê±´ì„ ë™ì¼í•˜ê²Œ ë†“ê³  ë°©ë²•ë§Œ **ë£½ê²Œ-ì¿ íƒ€**(Runge-Kutta 4th order) ë°©ë²•ìœ¼ë¡œ ë°”ê¾¸ë©´ ë‹¤ìŒì˜ ê·¸ë¦¼ì´ ë‚˜ì˜µë‹ˆë‹¤.

![Lorenz Butterfly (RK4)](/posts/images/rk4.png)

ì˜¤ë¡œì§€ ë°©ë²•ë§Œ ë°”ê¾¸ì—ˆì„ ë¿ì¸ë° ê²°ê³¼ê°€ ìƒë‹¹íˆ ë§ì´ ë‹¤ë¥¸ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¬¼ë¡  ì´ ê²½ìš°ì—ëŠ” ì „ì²´ì ì¸ í˜•íƒœëŠ” ë°”ë€Œì§€ ì•Šì§€ë§Œ, íŠ¹ì • ë§¤ê°œë³€ìˆ˜ ì£¼ë³€ì—ì„œëŠ” ì•„ì˜ˆ í˜•íƒœ ì „ì²´ê°€ ê¸‰ê²©í•˜ê²Œ ë³€í˜•ë˜ëŠ” ê²½ìš°ë„ ë°œìƒí•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê²½ìš°ì—ëŠ” ì˜¤ì°¨ê°€ í•„ì—°ì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ìˆ˜ì¹˜ì  ë¯¸ë¶„ ë°©ë²•ì´ ì í•©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì´ëŸ° ê²½ìš°ì—ëŠ” ì–´ë–»ê²Œ í’€ì–´ì•¼ í• ê¹Œìš”?

-----

## ğŸ‡¬ğŸ‡· ê¸°í˜¸ì  ë¯¸ë¶„ (Symbolic Differentiation)

ì¸ê°„ì€ ì ì ˆí•œ êµìœ¡ë§Œ ë°›ëŠ”ë‹¤ë©´ ë¯¸ë¶„ì„ ì•„ë¬´ëŸ° ì˜¤ì°¨ì—†ì´ ê³„ì‚°í•´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ë¬¼ë¡ , ê³„ì‚°ì‹¤ìˆ˜ë¡œ ì¸í•œ ì˜¤ì°¨ëŠ” ì¢…ì¢… ë°œìƒí•©ë‹ˆë‹¤.)
ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒ í•¨ìˆ˜ì˜ ë„í•¨ìˆ˜ë¥¼ ìƒê°í•´ë´…ì‹œë‹¤.

$$
y = x^2
$$

ì´ì „ ê¸€ì—ì„œ ë‹¤ë£¨ì—ˆë‹¤ì‹œí”¼ ìˆ˜ì¹˜ì  ë¯¸ë¶„ êµ¬í˜„ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ë„ˆë¬´ ë˜‘ê°™ìœ¼ë©´ ì‹¬ì‹¬í•˜ë‹ˆ ìš”ì¦˜ ê°ê´‘ë°›ëŠ” ìˆ˜ì¹˜ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì¸ Juliaë¡œ í‘œí˜„í•´ë³´ê² ìŠµë‹ˆë‹¤.

```julia
# Julia
function df(x, f, h=1e-06)
  return (f(x+h) - f(x)) / h
end

# Derivative
dx2(x) = df(x, x -> x^2)

# Print
println(dx2(1)) # 2.0000009999243673
```

ì´ë²ˆì—” ê³ ë“±í•™ìƒì´ í‘¸ëŠ” ë°©ë²•ì„ ì‚´í´ë´…ì‹œë‹¤. (ëŒ€í•œë¯¼êµ­ ê³ ë“±í•™êµ 2í•™ë…„ ìˆ˜í•™2 ê³¼ì •ì„ ì´ìˆ˜í•œ í•™ìƒì´ë¼ê³  ê°€ì •í•©ë‹ˆë‹¤.)

$$
\begin{align}
\frac{d}{dx}(x^2) &= \lim_{h \rightarrow 0} \frac{(x+h)^2 - x^2}{h} \\\\
&= \lim_{h\rightarrow 0} \frac{2hx + h^2}{h} \\\\
&= 2x
\end{align}
$$

ì—¬ê¸°ì— 1ì„ ëŒ€ì…í•˜ë©´ ì •í™•íˆ 2ê°€ ë‚˜ì˜µë‹ˆë‹¤. ìœ„ì—ì„œ ìˆ˜ì¹˜ì  ë¯¸ë¶„ì˜ ê²°ê³¼ì™€ ë‹¬ë¦¬ ì˜¤ì°¨ëŠ” í¬í•¨ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
ë¯¸ë¶„ì„ ë°°ìš´ ì‚¬ëŒì¼ ê²½ìš°, ìœ„ í’€ì´ëŠ” ì „í˜€ ì–´ë ¤ìš´ í’€ì´ê°€ ì•„ë‹™ë‹ˆë‹¤. ê·œì¹™ë§Œ ì˜ ì§€í‚¨ë‹¤ë©´ ë‹¤ë¥¸ í•¨ìˆ˜ë“¤ì„ ë¯¸ë¶„í•  ë•Œì—ë„ í° ì–´ë ¤ì›€ì€ ì—†ì„ ê²ë‹ˆë‹¤.

{{<img src="/posts/images/diff_table.gif" caption="ë¬¼ë¡  ê·œì¹™ì´ ì¡°ê¸ˆ ë§ê¸´ í•©ë‹ˆë‹¤ ã…ã….." >}}

ê·¸ë ‡ë‹¤ë©´ ì»´í“¨í„°ì—ê²Œ ê·œì¹™ì„ ê°€ë¥´ì¹˜ë©´ ì–´ë–¨ê¹Œìš”? ì–´ë–»ê²Œ ê°€ë¥´ì¹˜ëƒê°€ ê´€ê±´ì´ê² ì§€ë§Œ ì¼ë‹¨ ê°€ë¥´ì¹  ìˆ˜ ìˆë‹¤ë©´ ì˜¤ì°¨ì—†ëŠ” ì™„ë²½í•œ ë¯¸ë¶„ì„ ì»´í“¨í„°ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.
ë‹¤í–‰íˆë„ ì‚¬ëŒë“¤ì€ ì´ë¯¸ ê·¸ê²ƒì„ êµ¬í˜„í•˜ì˜€ê³  ì´ë¥¼ **CAS**(Computer Algebra System)ë¼ ë¶€ë¦…ë‹ˆë‹¤.

ëŒ€í‘œì ì¸ CASë¡œëŠ” Mathematica, Matlab, Maple ë“±ì˜ ìƒì—…ìš© í”„ë¡œê·¸ë¨ë“¤ê³¼ Pythonìœ¼ë¡œ êµ¬í˜„ëœ Sympy, Sagemath ë“±ì˜ ë¬´ë£Œ í”„ë¡œê·¸ë¨ í˜¹ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆìŠµë‹ˆë‹¤.
CASëŠ” ì‹¤ì œë¡œ ì¸ê°„ì´ í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë¯¸ë¶„, ì ë¶„, ëŒ€ìˆ˜ ë¿ ì•„ë‹ˆë¼ ì‹¬ì§€ì–´ ë¯¸ë¶„ê¸°í•˜ ë“±ì˜ ê³ ê¸‰ ìˆ˜í•™ ë¬¸ì œê¹Œì§€ë„ í’€ì–´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{{<img src="/posts/images/sage_manifolds.png" caption="ë¬´ë ¤ ì´ë¦„ë„ SageManifolds ì…ë‹ˆë‹¤.">}}

ì•„ë˜ëŠ” sagemathë¥¼ ì´ìš©í•œ ê°„ë‹¨í•œ ë„í•¨ìˆ˜ êµ¬í˜„ì…ë‹ˆë‹¤.

```python
var('x')        # ë³€ìˆ˜ë¥¼ ì„ ì–¸í•©ë‹ˆë‹¤.
f(x) = x^2      # í•¨ìˆ˜ë¥¼ ì„ ì–¸í•©ë‹ˆë‹¤.
df = diff(f, x) # ë„í•¨ìˆ˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
print(df(1))    # 2
```

ì •í™•í•  ë¿ë§Œ ì•„ë‹ˆë¼ ê°„ë‹¨í•˜ê¸°ê¹Œì§€ í•˜ë‹ˆ ë” ì´ìƒ ìˆ˜ì¹˜ì  ë¯¸ë¶„ì„ ê³ ì§‘í•  ì´ìœ ëŠ” ì—†ì–´ë³´ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ë ‡ê²Œ ì—„ì²­ë‚œ CASì—ë„ ì¹˜ëª…ì ì¸ ë‹¨ì ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë°”ë¡œ ì†ë„ì…ë‹ˆë‹¤.
ê¸°í˜¸ì  ë¯¸ë¶„ ìì²´ëŠ” ê³„ì‚° ì†ë„ê°€ ë¹ ë¥¼ ìˆ˜ ìˆì§€ë§Œ ê·¸ê²ƒì— ìˆ˜ì¹˜ ê°’ë“¤ì„ ëŒ€ì…í•  ë•Œ í˜„ì €í•˜ê²Œ ì†ë„ ì €í•˜ê°€ ì¼ì–´ë‚©ë‹ˆë‹¤. ì•„ë˜ëŠ” ê°„ë‹¨í•œ ë¯¸ë¶„ ê³„ì‚°ì— í¬ê¸°ê°€ í° ë°°ì—´ ê°’ì„ ëŒ€ì…í•˜ì—¬ ì„±ëŠ¥ì„ ì¸¡ì •í•œ ê²°ê³¼ì…ë‹ˆë‹¤. PeroxideëŠ” Rustì˜ ìˆ˜ì¹˜ê³„ì‚° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ë¦„ì´ë©° í›„ì— ë‹¤ë£° ìë™ë¯¸ë¶„ ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•˜ì—¬ ê³„ì‚°ì„ ìˆ˜í–‰í•˜ì˜€ê³ , numpyëŠ” Pythonì˜ ìœ ëª…í•œ ìˆ˜ì¹˜ê³„ì‚° ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ìˆ˜ì¹˜ì  ë¯¸ë¶„ìœ¼ë¡œ ê³„ì‚°í•˜ì˜€ìŠµë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ SagemathëŠ” ê¸°í˜¸ì  ë¯¸ë¶„ìœ¼ë¡œ ê³„ì‚° í›„ ìˆ˜ì¹˜ ê°’ì„ ëŒ€ì…í•˜ì—¬ ê²°ê³¼ë¥¼ êµ¬í–ˆìŠµë‹ˆë‹¤.

{{<img src="/posts/images/plot.png" caption="Linear scale ê·¸ë˜í”„ì…ë‹ˆë‹¤.">}}

{{<img src="/posts/images/logplot.png" caption="Log scale ê·¸ë˜í”„ì…ë‹ˆë‹¤.">}}

ë¬¼ë¡  ì–´ë–¤ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í–ˆëŠ”ì§€ì— ë”°ë¼ ì‹¤ì œ ìˆ˜ì¹˜ ê³„ì‚°ì—ì„œì˜ ê²°ê³¼ëŠ” ì¡°ê¸ˆ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒì€ Julia ì–¸ì–´ íŒ€ì—ì„œ ì‹¤ì‹œí•œ Benchmark ê²°ê³¼ì…ë‹ˆë‹¤.

{{<img src="/posts/images/benchmarks.svg" caption="Log scaleì„ì„ ì°¸ê³ í•˜ì—¬ ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤. (ì¶œì²˜: https://julialang.org/benchmarks/)">}}

ê·¸ë¦¼ì„ ë³´ë©´ Matlabì˜ ì˜¤í”ˆì†ŒìŠ¤ ê²©ì¸ OctaveëŠ” ì˜ˆì™¸ë¡œ ì¹˜ë”ë¼ë„ Mathematicaê°€ ìƒê°ë³´ë‹¨ ëŠë¦¬ì§€ ì•ŠìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ê·¸ë˜ë„ Cë³´ë‹¤ ê±°ì˜ 10~100ë°° ëŠë¦¬ê¸´ í•˜ì§€ë§Œìš”.)
Mathematicaë„ í–‰ë ¬ ê³„ì‚°ì€ BLASë¥¼ ì´ìš©í•˜ê³  ê°–ê°€ì§€ íƒì›”í•œ ìˆ˜ì¹˜ ê³„ì‚° ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ê¸°ì— íŠ¹ì • ê³„ì‚°ë“¤ì€ ì‹¬ì§€ì–´ numpyë¥¼ ì´ìš©í•œ Pythonë³´ë‹¤ ë¹ ë¥´ê¸°ê¹Œì§€ í•©ë‹ˆë‹¤. ë‹¤ë§Œ, Mathematicaì—ì„œë„ ê¸°í˜¸ì  ë¯¸ë¶„ê³¼ ìˆ˜ì¹˜ì ì¸ ì—°ì‚°ì„ ì„œë¡œ ì˜¤ê°ˆë•Œì—ëŠ” ì—­ì‹œë‚˜ í° ì†ë„ì €í•˜ê°€ í•„ì—°ì ìœ¼ë¡œ ë°œìƒí•©ë‹ˆë‹¤. 

ê·¸ë ‡ë‹¤ë©´ ê·œëª¨ê°€ í° ë¯¸ë¶„ ê³„ì‚°ì— ëŒ€í•´ì„œëŠ” ì–´ë–»ê²Œ ì ‘ê·¼í•´ì•¼í• ê¹Œìš”? ì†ë„ ì €í•˜ë¥¼ ê³ ë ¤í•˜ì—¬ ìˆ˜ì¹˜ì  ë¯¸ë¶„ìœ¼ë¡œ êµ¬í˜„í•˜ìë‹ˆ ê·œëª¨ê°€ ì»¤ì„œ ì˜¤ì°¨ë„ ê·¸ë§Œí¼ ë§ì´ ìŒ“ì¼í…Œê³ , ì •í™•ë„ë¥¼ ê³ ë ¤í•˜ì—¬ ê¸°í˜¸ì  ë¯¸ë¶„ì„ ê³ ë ¤í•˜ìë‹ˆ êµ‰ì¥íˆ ì˜¤ëœ ì‹œì¼ì´ ê±¸ë¦´ ê²ƒì€ ë»”í•©ë‹ˆë‹¤. ì‹¬ì§€ì–´ ë©”ëª¨ë¦¬ ë¬¸ì œë¡œ ê²Œì‚° ë„ì¤‘ì— ë‹¤ìš´ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë‹¤í–‰íˆë„ ë¯¸ë¶„ì— í•œí•´ì„œëŠ” ê±°ì˜ ì™„ë²½í•œ í•´ë‹µì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì´ì— ëŒ€í•´ì„œëŠ” ë‹¤ìŒ í¬ìŠ¤íŠ¸ì—ì„œ ë‹¤ë£¨ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

-----

## ğŸ”– ë¶€ë¡

### A. ë¡œë Œì¦ˆ ë‚˜ë¹„ ì½”ë“œ

ìœ„ì—ì„œ ì²¨ë¶€í•œ ë¡œë Œì¦ˆ ë‚˜ë¹„ ê·¸ë¦¼ë“¤ì€ Rustì˜ ìˆ˜ì¹˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ [Peroxide](https://github.com/Axect/Peroxide)ë¥¼ ì´ìš©í•˜ì—¬ ê³„ì‚°í•˜ì˜€ìŠµë‹ˆë‹¤. ì†ŒìŠ¤ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```rust
extern crate peroxide;
use peroxide::fuga::*;

fn main() -> Result<(), Box<dyn Error>> {
    // =========================================
    //  Declare ODE
    // =========================================
    let mut ex_test = ExplicitODE::new(butterfly);

    let init_state: State<f64> = State::new(
        0.0,
        vec![10.0, 1.0, 1.0],
        vec![0.0, 0.0, 0.0],
    );

    ex_test
        .set_initial_condition(init_state)
        .set_method(ExMethod::Euler)
        .set_step_size(0.01f64)
        .set_times(10000);

    let mut ex_test2 = ex_test.clone();
    ex_test2.set_method(ExMethod::RK4);

    // =========================================
    //  Save results
    // =========================================
    let results = ex_test.integrate();
    let results2 = ex_test2.integrate();

    let mut df_euler = DataFrame::from_matrix(results);
    df_euler.set_header(vec!["t", "x", "y", "z"]);
    df_euler.print();

    let mut df_rk4 = DataFrame::from_matrix(results2);
    df_rk4.set_header(vec!["t", "x", "y", "z"]);
    df_rk4.print();

    df_euler.write_nc("data/euler.nc")?;
    df_rk4.write_nc("data/rk4.nc")?;

    Ok(())
}

fn butterfly(st: &mut State<f64>, _: &NoEnv) {
    let x = &st.value;
    let dx = &mut st.deriv;
    dx[0] = 10f64 * (x[1] - x[0]);
    dx[1] = 28f64 * x[0] - x[1] - x[0] * x[2];
    dx[2] = -8f64/3f64 * x[2] + x[0] * x[1];
}
```

ì´í›„ì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì„œ ê·¸ë¦¼ì„ ê·¸ë¦¬ëŠ” ê²ƒì€ Pythonìœ¼ë¡œ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```python
from netCDF4 import Dataset
import matplotlib.pyplot as plt

# Import netCDF file
ncfile1 = './data/euler.nc'
data1 = Dataset(ncfile1)
var1 = data1.variables
ncfile2 = './data/rk4.nc'
data2 = Dataset(ncfile2)
var2 = data2.variables

# Use latex
plt.rc('text', usetex=True)
plt.rc('font', family='serif')

# Prepare Plot
plt.figure(figsize=(10,6), dpi=300)
plt.title(r"Lorenz Butterfly (Euler)", fontsize=16)
plt.xlabel(r'$x$', fontsize=14)
plt.ylabel(r'$z$', fontsize=14)

# Prepare Data to Plot
x1 = var1['x'][:]
z1 = var1['z'][:]  

# Plot with Legends
plt.plot(x1, z1, label=r'Lorenz (Euler)')

# Other options
plt.legend(fontsize=12)
plt.grid()
plt.savefig("euler.png", dpi=300)

# Prepare Plot
plt.figure(figsize=(10,6), dpi=300)
plt.title(r"Lorenz Butterfly (RK4)", fontsize=16)
plt.xlabel(r'$x$', fontsize=14)
plt.ylabel(r'$z$', fontsize=14)

# Prepare Data to Plot
x2 = var2['x'][:]
z2 = var2['z'][:]  

# Plot with Legends
plt.plot(x2, z2, label=r'Lorenz (RK4)')

# Other options
plt.legend(fontsize=12)
plt.grid()
plt.savefig("rk4.png", dpi=300)
```

ì´ì™¸ì— ìì„¸í•œ ì‚¬í•­ì€ [Peroxide Gallery](https://github.com/Axect/Peroxide_Gallery)ì— ë‚˜ì™€ìˆìœ¼ë‹ˆ ì°¸ê³ í•˜ì‹œë©´ ë©ë‹ˆë‹¤.